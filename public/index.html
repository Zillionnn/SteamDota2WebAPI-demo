<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
123
<a href="test.html">test</a>
<div id="user-section">

</div>
<div id="user-recent-played-games">

</div>

<br/>
<hr/>
<p>get Match history by hero_id  account_id  invoker(74)</p>
<div id="user-invoker-play-history">

</div>
</body>
</html>
<script src="/javascripts/jquery.js"></script>
<script>
 $.ajax({
     url:'/users/userinfo',
     method:'GET',
     dataType:'json',
     success:function (data) {
       //  console.log(data);
         let player=data.response.players[0];
         let   steamid=player.steamid;
         let  avatarfull=player.avatarfull;

         document.getElementById("user-section").innerHTML=`
<p>${steamid}</p>
<img src="${avatarfull}">
`;
     },
     error:function (err) {
         console.log(err);
     },
     statusCode:{
         200:function () {
             console.log("200");
         }
     }
 });

 $.ajax({
     url:'/users/userRecentlyPlayedGames',
     method:'GET',
     dataType:'json',
     success:function (data) {

         let games=data.response.games;
      //   console.log(games);

         for(var i in games){
             let childNode=document.createElement('div');
             let imgUrl=`http://media.steampowered.com/steamcommunity/public/images/apps/${games[i].appid}/${games[i].img_logo_url}`;
             childNode.innerHTML=`
<p>
            ${games[i].name}<br/>
             play time in 2 weeks:${games[i].playtime_2weeks}h<br/>
             play total time:${games[i].playtime_forever}h<br/>
         </p>


          `;
             document.getElementById("user-recent-played-games").appendChild(childNode);

         }

     },
     error:function (err) {
         console.log(err);
     },
     statusCode:{
         200:function () {
             console.log("200");
         }
     }
 });



 $.ajax({
     url:'/users/getMatchHistoryByHero',
     method:'GET',
     dataType:'json',
     success:function (data) {

        // console.log(data);
         //array
         let result=data.result.matches;
       //  console.log(result[0]);

        let  start_time=result[0].start_time*1000;
         start_time=new Date(start_time).toLocaleString();
         let match_id=result[0].match_id;
         let players=result[0].players;

         document.getElementById("user-invoker-play-history").innerHTML=`
         <p>比赛ID：${match_id}</p>
         <p>比赛时间：${start_time}</p>
         <div style='float: left;'>
         <p id="${match_id}-player0-4"></p>
         </div>

             <div style='float: left;margin-left:3em'>
         <p id="${match_id}-player5-9"></p>
         </div>
         `;
         let jinwei=`${match_id}-player0-4`;
         let tianzai=`${match_id}-player5-9`;

         ///
         for(var i =0;i<5;i++){
             let playerNode=document.createElement('p');

            for(var j in HeroArray){
                if(players[i].hero_id==HeroArray[j].id){
                    players[i].hero_name=HeroArray[j].localized_name;
                    break;
                }
            }

             playerNode.innerHTML=`${players[i].account_id}----${players[i].hero_name}`;
             document.getElementById(jinwei).appendChild(playerNode);
         }

         for(var i =5;i<10;i++){
             let playerNode=document.createElement('p');
             for(var j in HeroArray){
                 if(players[i].hero_id==HeroArray[j].id){
                     players[i].hero_name=HeroArray[j].localized_name;
                     break;
                 }
             }

             playerNode.innerHTML=`${players[i].account_id}----${players[i].hero_name}`;
             document.getElementById(tianzai).appendChild(playerNode);
         }
         ///



     },
     error:function (err) {
         console.log(err);
     },
     statusCode:{
         200:function () {
             console.log("200");
         }
     }
 });
let  HeroArray=[];

getHeroes();
    function getHeroes() {
        $.ajax({
            url:'hero/getHeroes',
            method:'GET',
            dataType:'json',
            success:function (data) {
                //console.log(data);
                HeroArray=data.result.heroes;
          //   console.log(HeroArray);
            },
            error:function (err) {
                console.log("getHeroes>>",err);
            }
        });
    }
</script>